<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Snake Game</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
    body {
        margin: 0;
        background: #000;
        overflow: hidden;
    }
    #header {
        color: #fff;
        font-family: Arial, sans-serif;
        font-size: 18px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 6px;
    }
    #score {
        font-size: 20px;
        margin-right: 20px;
    }
    #icons div {
        display: inline-block;
        width: 20px;
        height: 20px;
        margin: 0 3px;
        cursor: pointer;
        background: #666;
    }
    .easy_active { background: green !important; }
    .medium_active { background: orange !important; }
    .hard_active { background: red !important; }
    .pause, .play { background: #fff; }
    #overlay {
        position: absolute;
        top: 0; left: 0;
        background: rgba(0,0,0,0.8);
        color: white;
        text-align: center;
    }
    .play_now, .play_again {
        background: #fff;
        color: #000;
        padding: 10px 20px;
        font-size: 24px;
        cursor: pointer;
        display: inline-block;
    }
</style>
<script>
    var canvas = null,
        cur_pos = {x: 50, y: 50},
        grid_size = 10,
        dir = 'right',
        body = [],
        body_len = 3,
        food_point = null,
        ctx = null,
        score = 0,
        snake_movement = null,
        press_keys = true,
        speed = 100;

    function start(){
        ctx.clearRect(0,0, canvas.width, canvas.height);
        document.getElementById('overlay').style.display =
        document.getElementById('start').style.display =
        document.getElementById('game_over').style.display = 'none';
        cur_pos = {x: 50, y: 50};
        body = [];
        body_len = 3;
        make_food();
        draw_snake();
        dir = 'right';
        score = 0;
        if (snake_movement) clearInterval(snake_movement);
        play();
    }

    function canvas_support() {
        canvas = document.getElementById('board');
        if (canvas.getContext) {
            canvas.width = Math.floor(((window.innerWidth - 16) / 10)) * 10;
            canvas.height = Math.floor(((window.innerHeight - 56) / 10)) * 10;
            document.getElementById('header').style.width = canvas.width + 'px';
            document.getElementById('overlay').style.width = canvas.width + 2 + 'px';
            document.getElementById('overlay').style.height = canvas.height + 2 + 'px';
            ctx = canvas.getContext('2d');
            document.getElementById('overlay').style.display =
            document.getElementById('start').style.display = 'block';
        } else {
            alert("Your browser does not support canvas.");
        }
    }

    window.onkeydown = function(event) {
        if (!press_keys) return null;
        var keyCode = event.keyCode;
        switch (keyCode) {
            case 65: case 37: if (dir != 'right') left(); break;
            case 87: case 38: if (dir != 'down') up(); break;
            case 68: case 39: if (dir != 'left') right(); break;
            case 83: case 40: if (dir != 'up') down(); break;
        }
    }

    function move_snake(){
        switch (dir) {
            case 'left': left(); break;
            case 'up': up(); break;
            case 'right': right(); break;
            case 'down': down(); break;
        }
    }

    function draw_snake() {
        if (body.some(eat_snake)) { game_over(); return false; }
        ctx.fillStyle = 'yellow';
        body.push([cur_pos['x'], cur_pos['y']]);
        ctx.fillRect(cur_pos['x'], cur_pos['y'], grid_size, grid_size);
        if (body.length > body_len) {
            var remove = body.shift();
            ctx.clearRect(remove[0], remove[1], grid_size, grid_size);
        }
        if (cur_pos['x'] == food_point[0] && cur_pos['y'] == food_point[1]) {
            make_food();
            body_len++;
            update_score();
        }
    }

    function left_pos() { return cur_pos['x'] - grid_size; }
    function right_pos() { return cur_pos['x'] + grid_size; }
    function up_pos() { return cur_pos['y'] - grid_size; }
    function down_pos() { return cur_pos['y'] + grid_size; }

    function up() {
        if (up_pos() >= 0) do_move('up', 'y', up_pos());
        else auto_dir('x');
    }
    function down() {
        if (down_pos() < canvas.height) do_move('down', 'y', down_pos());
        else auto_dir('x');
    }
    function left() {
        if (left_pos() >= 0) do_move('left', 'x', left_pos());
        else auto_dir('y');
    }
    function right() {
        if (right_pos() < canvas.width) do_move('right', 'x', right_pos());
        else auto_dir('y');
    }

    function do_move(new_dir, xy, value) {
        dir = new_dir;
        cur_pos[xy] = value;
        draw_snake();
    }

    function auto_dir(xy) {
        (xy == 'x')
            ? (cur_pos['x'] > canvas.width / 2 ? left() : right())
            : (cur_pos['y'] > canvas.height / 2 ? up() : down());
    }

    function make_food() {
        food_point = [
            Math.floor(Math.random() * (canvas.width / grid_size)) * grid_size,
            Math.floor(Math.random() * (canvas.height / grid_size)) * grid_size
        ];
        if (body.some(has_point)) {
            make_food();
        } else {
            ctx.fillStyle = 'red';
            ctx.fillRect(food_point[0], food_point[1], grid_size, grid_size);
        }
    }

    function has_point(element) {
        return (element[0] == food_point[0] && element[1] == food_point[1]);
    }

    function eat_snake(element) {
        return (element[0] == cur_pos['x'] && element[1] == cur_pos['y']);  
    }

    function update_score() {
        if (speed == 25) score += 25;
        else if (speed == 50) score += 15;
        else if (speed == 100) score += 10;
        document.getElementById('score').innerHTML = score;
    }

    function change_speed(level) {
        speed = level;
        document.getElementById('easy').className = 'easy';
        document.getElementById('medium').className = 'medium';
        document.getElementById('hard').className = 'hard';
        if (level == 25) document.getElementById('hard').className += ' hard_active';
        else if (level == 50) document.getElementById('medium').className += ' medium_active';
        else if (level == 100) document.getElementById('easy').className += ' easy_active';
        if (press_keys) {
            clearInterval(snake_movement);
            snake_movement = setInterval(move_snake, speed);
        }
    }

    function pause(){
        clearInterval(snake_movement);
        press_keys = false;
        document.getElementById('pause').style.display = 'none';
        document.getElementById('play').style.display = 'block';
        document.getElementById('overlay').style.display = 
        document.getElementById('paused').style.display = 'block';
    }

    function play(){
        snake_movement = setInterval(move_snake, speed);
        press_keys = true;
        document.getElementById('play').style.display = 'none';
        document.getElementById('pause').style.display = 'block';
        document.getElementById('overlay').style.display =
        document.getElementById('paused').style.display = 'none';
    }

    function game_over() {
        pause();
        body = [];
        body_len = 3;
        document.getElementById('points').innerHTML = score;
        document.getElementById('paused').style.display = 'none';
        document.getElementById('overlay').style.display = 
        document.getElementById('game_over').style.display = 'block';
        ctx.clearRect(0,0, canvas.width, canvas.height);
        score = 0;
        document.getElementById('score').innerHTML = score;
    }
</script>
</head>
<body onload="canvas_support()">
    <div id="header">
        <div><b>Snake Game</b></div>
        <div id="score">0</div>
        <div id="icons">
            <div id="easy" class="easy easy_active" title="Easy" onclick="change_speed(100)"></div>
            <div id="medium" class="medium" title="Medium" onclick="change_speed(50)"></div>
            <div id="hard" class="hard" title="Hard" onclick="change_speed(25)"></div>
            <div id="pause" class="pause" onclick="pause()" style="display: block;"></div>
            <div id="play" class="play" onclick="play()" style="display: none;"></div>
        </div>
    </div>
    <canvas id="board"></canvas>
    <div id="overlay" style="display: none;">
        <div id="start" style="display: none;">
            <div style="position: absolute; top: 50%; margin-top: -100px; width: 100%;">
                <div class="play_now" onclick="start()">Play Now!</div>
            </div>
        </div>
        <div id="paused" style="display: none;">
            <div style="position: absolute; top: 50%; margin-top: -100px; width: 100%;">
                <div style="margin: 0 auto; height: 100px; font-size: 500%;">PAUSED</div>
            </div>
        </div>
        <div id="game_over" style="display: none;">
            <div style="position: absolute; top: 50%; margin-top: -200px; width: 100%;">
                <div style="margin: 0 auto; height: 2100px; font-size: 500%; text-align: center;">
                    GAME OVER<br>
                    <span style="font-size: 40%;">You scored <span id="points"></span> points!</span><br><br>
                    <div class="play_again" onclick="start()">Play Again!</div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
